function bpmnModeler(e){return{restrict:"A",scope:{data:"=bpmnModeler"},link:function(t,o,n){var r=window.BpmnJS,i=(angular.element("#js-drop-zone"),new r({container:o}));e.get("http://localhost:4500/test").then(function(e){i.importXML(e.data.data,function(e){var t=i.get("canvas");t.zoom("fit-viewport")})})}}}var app=angular.module("stepNext",["ngRoute"]);app.config(["$routeProvider",function(e){e.when("/modeler",{templateUrl:"workflow/modeler.html",controller:"modelerController"}).when("/fileBrowser",{templateUrl:"workflow/fileBrowser.html",controller:"fileBrowserController"}).otherwise({redirectTo:"/modeler"})}]);var app=angular.module("stepNext");app.directive("bpmnModeler",["$http",bpmnModeler]),function(){"use strict";function e(e){var t={};return t.fetchFile=function(t){return e.get("/api/resource?resource="+encodeURIComponent(t))},t}var t=angular.module("stepNext");t.requires.push("jsTree.directive"),t.requires.push("ui.ace"),t.factory("FetchFileFactory",["$http",e])}(),function(){"use strict";function e(e,t,o,n,r){var i=ace.edit("aceEditor");e.fileViewer="Please select a file to view its contents",$(".content").hide(),$(".textContent").hide(),$("#message").html("<h4>Please select a file to view its contents</h4>");var s=window.BpmnJS;e.tree_core={multiple:!1,check_callback:function(e,t,o,n,r){return"move_node"!==e}},e.nodeSelected=function(l,a){var c=a.node.li_attr;if(c.isLeaf)if(c.id.indexOf(".pdf")>-1)$(".content").hide(),$(".textContent").show(),t.get("/api/resource?resource="+encodeURIComponent(c.base),{responseType:"arraybuffer"}).success(function(t){var n=new Blob([t],{type:"application/pdf"}),i=URL.createObjectURL(n);e.pdfUrl=o.trustAsResourceUrl(i).toString(),r.$getByHandle("my-pdf-container").load(e.pdfUrl),$("#save").hide(),$("#aceEditor").hide(),$("#message").html(""),$("#pdfViewer").show()}).error(function(){console.log("Error in reading pdf")});else if(c.id.indexOf(".bpmn")>-1){$(".textContent").hide(),$(".bjs-container").remove(),$("#message").html(""),$(".content").show();var d=angular.element("#js-drop-zone"),f=new s({container:d});n.fetchFile(c.base).then(function(e){var t=e.data;"object"==typeof t&&(t=JSON.stringify(t,void 0,2));var o=t;f.importXML(o,function(e){var t=f.get("canvas");t.zoom("fit-viewport")})}),e.saveBpmn=function(){var e;f.saveXML({format:!0},function(t,o){e=o}),t.post("/save",{content:e}).success(function(e){"Success"==e&&$("#message").html("Workflow edited successfully")})}}else $(".content").hide(),$("#message").html(""),$(".textContent").show(),n.fetchFile(c.base).then(function(t){var o=t.data;"object"==typeof o&&(o=JSON.stringify(o,void 0,2)),e.fileViewer=o,$("#save").show(),$("#message").html(""),c.id.indexOf(".xml")>-1||c.id.indexOf(".xsd")>-1||c.id.indexOf(".activiti")>-1?i.session.setMode("ace/mode/xml"):c.id.indexOf(".drl")>-1?i.session.setMode("ace/mode/drlfile"):c.id.indexOf(".html")>-1?i.session.setMode("ace/mode/html"):c.id.indexOf(".groovy")>-1?i.session.setMode("ace/mode/groovy"):c.id.indexOf(".properties")>-1?i.session.setMode("ace/mode/properties"):i.session.setMode("ace/mode/text"),$("#aceEditor").show(),$("#pdfViewer").hide(),i.$blockScrolling=1/0,i.setReadOnly(!1),i.setValue(o)});else e.$apply(function(){e.fileViewer="Please select a file to view its contents",$(".textContent").hide(),$(".content").hide(),$("#message").html("<h4>Please select a file to view its contents</h4>")})}}var t=angular.module("stepNext");t.requires.push("jsTree.directive"),t.requires.push("ui.ace"),t.requires.push("pdf"),t.controller("fileBrowserController",["$scope","$http","$sce","FetchFileFactory","pdfDelegate",e])}(),function(){function e(e,t){e.schema=""}angular.module("stepNext").controller("modelerController",["$scope","$http",e])}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJwbW4tbW9kZWxlci5qcyIsImFwcC5tb2R1bGUuanMiLCJmYWN0b3J5LmpzIiwiZmlsZUJyb3dzZXIuanMiLCJtb2RlbGVyLmpzIl0sIm5hbWVzIjpbImJwbW5Nb2RlbGVyIiwiJGh0dHAiLCJyZXN0cmljdCIsInNjb3BlIiwiZGF0YSIsImxpbmsiLCJlbGVtZW50IiwiYXR0cnMiLCJCcG1uTW9kZWxlciIsIndpbmRvdyIsIkJwbW5KUyIsInJlbmRlcmVyIiwiYW5ndWxhciIsImNvbnRhaW5lciIsImdldCIsInRoZW4iLCJyZXMiLCJpbXBvcnRYTUwiLCJlcnIiLCJjYW52YXMiLCJ6b29tIiwiYXBwIiwibW9kdWxlIiwiY29uZmlnIiwiJHJvdXRlUHJvdmlkZXIiLCJ3aGVuIiwidGVtcGxhdGVVcmwiLCJjb250cm9sbGVyIiwib3RoZXJ3aXNlIiwicmVkaXJlY3RUbyIsImRpcmVjdGl2ZSIsImZldGNoRmlsZUZhY3RvcnkiLCJfZmFjdG9yeSIsImZldGNoRmlsZSIsImZpbGUiLCJlbmNvZGVVUklDb21wb25lbnQiLCJyZXF1aXJlcyIsInB1c2giLCJmYWN0b3J5IiwiZmlsZUJyb3dzZXJDb250cm9sbGVyIiwiJHNjb3BlIiwiJHNjZSIsIkZldGNoRmlsZUZhY3RvcnkiLCJwZGZEZWxlZ2F0ZSIsImVkaXRvciIsImFjZSIsImVkaXQiLCJmaWxlVmlld2VyIiwiJCIsImhpZGUiLCJodG1sIiwiQnBtblZpZXdlciIsInRyZWVfY29yZSIsIm11bHRpcGxlIiwiY2hlY2tfY2FsbGJhY2siLCJvcGVyYXRpb24iLCJub2RlIiwibm9kZV9wYXJlbnQiLCJub2RlX3Bvc2l0aW9uIiwibW9yZSIsIm5vZGVTZWxlY3RlZCIsImUiLCJfbCIsImxpX2F0dHIiLCJpc0xlYWYiLCJpZCIsImluZGV4T2YiLCJzaG93IiwiYmFzZSIsInJlc3BvbnNlVHlwZSIsInN1Y2Nlc3MiLCJyZXNwb25zZSIsIkJsb2IiLCJ0eXBlIiwiZmlsZVVSTCIsIlVSTCIsImNyZWF0ZU9iamVjdFVSTCIsInBkZlVybCIsInRydXN0QXNSZXNvdXJjZVVybCIsInRvU3RyaW5nIiwiJGdldEJ5SGFuZGxlIiwibG9hZCIsImVycm9yIiwiY29uc29sZSIsImxvZyIsInJlbW92ZSIsInZpZXdlciIsIl9kIiwiSlNPTiIsInN0cmluZ2lmeSIsInVuZGVmaW5lZCIsInhtbCIsInNhdmVCcG1uIiwiYnBtblhtbCIsInNhdmVYTUwiLCJmb3JtYXQiLCJwb3N0IiwiY29udGVudCIsInNlc3Npb24iLCJzZXRNb2RlIiwiJGJsb2NrU2Nyb2xsaW5nIiwiSW5maW5pdHkiLCJzZXRSZWFkT25seSIsInNldFZhbHVlIiwiJGFwcGx5IiwibW9kZWxlckNvbnRyb2xsZXIiLCJzY2hlbWEiXSwibWFwcGluZ3MiOiJBQUNBLFFBQUFBLGFBQUFDLEdBRUEsT0FDQUMsU0FBQSxJQUNBQyxPQUNBQyxLQUFBLGdCQUVBQyxLQUFBLFNBQUFGLEVBQUFHLEVBQUFDLEdBQ0EsR0FBQUMsR0FBQUMsT0FBQUMsT0FNQUMsR0FKQUMsUUFBQU4sUUFBQSxpQkFJQSxHQUFBRSxJQUFBSyxVQUFBUCxJQUVBTCxHQUFBYSxJQUFBLDhCQUFBQyxLQUFBLFNBQUFDLEdBQ0FMLEVBQUFNLFVBQUFELEVBQUFaLEtBQUFBLEtBQUEsU0FBQWMsR0FDQSxHQUFBQyxHQUFBUixFQUFBRyxJQUFBLFNBQ0FLLEdBQUFDLEtBQUEsc0JDcEJBLEdBQUFDLEtBQUFULFFBQUFVLE9BQUEsWUFBQSxXQUVBRCxLQUFBRSxRQUFBLGlCQUFBLFNBQUFDLEdBQ0FBLEVBQ0FDLEtBQUEsWUFDQUMsWUFBQSx3QkFDQUMsV0FBQSxzQkFFQUYsS0FBQSxnQkFDQUMsWUFBQSw0QkFDQUMsV0FBQSwwQkFFQUMsV0FDQUMsV0FBQSxlRGJBLElBQUFSLEtBQUFULFFBQUFVLE9BQUEsV0E0Q0FELEtBQUFTLFVBQUEsZUFBQSxRQUFBOUIsY0U1Q0EsV0FDQSxZQUNBLFNBQUErQixHQUFBOUIsR0FDQSxHQUFBK0IsS0FNQSxPQUpBQSxHQUFBQyxVQUFBLFNBQUFDLEdBQ0EsTUFBQWpD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LFFBQUEsUUFBQSxHQUNBdEIsRUFBQXNELFFBQUFDLFFBQUEsb0JBQ0FyQyxFQUFBRyxHQUFBQyxRQUFBLFNBQUEsR0FDQXRCLEVBQUFzRCxRQUFBQyxRQUFBLGlCQUNBckMsRUFBQUcsR0FBQUMsUUFBQSxXQUFBLEdBQ0F0QixFQUFBc0QsUUFBQUMsUUFBQSxtQkFDQXJDLEVBQUFHLEdBQUFDLFFBQUEsZUFBQSxHQUNBdEIsRUFBQXNELFFBQUFDLFFBQUEsdUJBRUF2RCxFQUFBc0QsUUFBQUMsUUFBQSxpQkFFQW5ELEVBQUEsY0FBQW1CLE9BQ0FuQixFQUFBLGNBQUFDLE9BQ0FMLEVBQUF3RCxnQkFBQUMsRUFBQUEsRUFDQXpELEVBQUEwRCxhQUFBLEdBQ0ExRCxFQUFBMkQsU0FBQWhCLFNBSUEvQyxHQUFBZ0UsT0FBQSxXQUNBaEUsRUFBQU8sV0FBQSw0Q0FDQUMsRUFBQSxnQkFBQUMsT0FDQUQsRUFBQSxZQUFBQyxPQUNBRCxFQUFBLFlBQUFFLEtBQUEseURBTUEsR0FBQTdCLEdBQUFULFFBQUFVLE9BQUEsV0FDQUQsR0FBQWUsU0FBQUMsS0FBQSxvQkFDQWhCLEVBQUFlLFNBQUFDLEtBQUEsVUFDQWhCLEVBQUFlLFNBQUFDLEtBQUEsT0FDQWhCLEVBQUFNLFdBQUEseUJBQUEsU0FBQSxRQUFBLE9BQUEsbUJBQUEsY0FBQVksT0MvSEEsV0FDQSxRQUFBa0UsR0FBQWpFLEVBQUF2QyxHQUVBdUMsRUFBQWtFLE9BQUEsR0FVQTlGLFFBQUFVLE9BQUEsWUFBQUssV0FBQSxxQkFBQSxTQUFBLFFBQUE4RSIsImZpbGUiOiJzdGVwLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnc3RlcE5leHQnKTtcclxuZnVuY3Rpb24gYnBtbk1vZGVsZXIoJGh0dHApIHtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHJlc3RyaWN0OiAnQScsXHJcbiAgICAgICAgc2NvcGU6IHtcclxuICAgICAgICAgICAgZGF0YTogXCI9YnBtbk1vZGVsZXJcIlxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgbGluazogZnVuY3Rpb24gKHNjb3BlLCBlbGVtZW50LCBhdHRycykge1xyXG4gICAgICAgICAgICB2YXIgQnBtbk1vZGVsZXIgPSB3aW5kb3cuQnBtbkpTO1xyXG5cclxuICAgICAgICAgICAgdmFyIGNvbnRhaW5lciA9IGFuZ3VsYXIuZWxlbWVudCgnI2pzLWRyb3Atem9uZScpO1xyXG5cclxuICAgICAgICAgICAgLy92YXIgY2FudmFzID0gYW5ndWxhci5lbGVtZW50KCcjanMtY2FudmFzJyk7XHJcblxyXG4gICAgICAgICAgICB2YXIgcmVuZGVyZXIgPSBuZXcgQnBtbk1vZGVsZXIoeyBjb250YWluZXI6IGVsZW1lbnQgfSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAkaHR0cC5nZXQoXCJodHRwOi8vbG9jYWxob3N0OjQ1MDAvdGVzdFwiKS50aGVuKGZ1bmN0aW9uIChyZXMpIHtcclxuICAgICAgICAgICAgICAgIHJlbmRlcmVyLmltcG9ydFhNTChyZXMuZGF0YS5kYXRhLCBmdW5jdGlvbiAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNhbnZhcyA9IHJlbmRlcmVyLmdldCgnY2FudmFzJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FudmFzLnpvb20oJ2ZpdC12aWV3cG9ydCcpO1xyXG4gICAgICAgICAgICAgICAgICAgIFxyXG4vLyAgICAgICAgICAgICAgICAgICAgIGlmIChlcnIpIHtcclxuLy8gICAgICAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyXHJcbi8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAucmVtb3ZlQ2xhc3MoJ3dpdGgtZGlhZ3JhbScpXHJcbi8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYWRkQ2xhc3MoJ3dpdGgtZXJyb3InKTtcclxuLy8gXHJcbi8vICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lci5maW5kKCcuZXJyb3IgcHJlJykudGV4dChlcnIubWVzc2FnZSk7XHJcbi8vIFxyXG4vLyAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XHJcbi8vICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuLy8gICAgICAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyXHJcbi8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAucmVtb3ZlQ2xhc3MoJ3dpdGgtZXJyb3InKVxyXG4vLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFkZENsYXNzKCd3aXRoLWRpYWdyYW0nKTtcclxuLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4vLyAgICAgICAgICAgICAgICAgICAgICAgICBcclxuLy8gICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cclxuYXBwLmRpcmVjdGl2ZSgnYnBtbk1vZGVsZXInLCBbJyRodHRwJywgYnBtbk1vZGVsZXJdKTsiLCJ2YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoXCJzdGVwTmV4dFwiLCBbJ25nUm91dGUnXSk7XHJcblxyXG5hcHAuY29uZmlnKFtcIiRyb3V0ZVByb3ZpZGVyXCIsIGZ1bmN0aW9uICgkcm91dGVQcm92aWRlcikge1xyXG4gICAgJHJvdXRlUHJvdmlkZXIuXHJcbiAgICAgICAgd2hlbignL21vZGVsZXInLCB7XHJcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnd29ya2Zsb3cvbW9kZWxlci5odG1sJyxcclxuICAgICAgICAgICAgY29udHJvbGxlcjogJ21vZGVsZXJDb250cm9sbGVyJ1xyXG4gICAgICAgIH0pLlxyXG4gICAgICAgIHdoZW4oJy9maWxlQnJvd3Nlcicse1xyXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3dvcmtmbG93L2ZpbGVCcm93c2VyLmh0bWwnLFxyXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnZmlsZUJyb3dzZXJDb250cm9sbGVyJ1xyXG4gICAgICAgIH0pLlxyXG4gICAgICAgIG90aGVyd2lzZSh7XHJcbiAgICAgICAgICAgIHJlZGlyZWN0VG86ICcvbW9kZWxlcidcclxuICAgICAgICB9KTsgICBcclxufV0pO1xyXG5cclxuIiwiKGZ1bmN0aW9uKCkge1xyXG4gICd1c2Ugc3RyaWN0JztcclxuICAgIGZ1bmN0aW9uIGZldGNoRmlsZUZhY3RvcnkoJGh0dHApIHtcclxuICAgICAgdmFyIF9mYWN0b3J5ID0ge307XHJcblxyXG4gICAgICBfZmFjdG9yeS5mZXRjaEZpbGUgPSBmdW5jdGlvbihmaWxlKSB7XHJcbiAgICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS9yZXNvdXJjZT9yZXNvdXJjZT0nICsgZW5jb2RlVVJJQ29tcG9uZW50KGZpbGUpKTtcclxuICAgICAgfTtcclxuXHJcbiAgICAgIHJldHVybiBfZmFjdG9yeTtcclxuICAgIH1cclxuICBcclxuICB2YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ3N0ZXBOZXh0Jyk7XHJcbiAgYXBwLnJlcXVpcmVzLnB1c2goJ2pzVHJlZS5kaXJlY3RpdmUnKTtcclxuICBhcHAucmVxdWlyZXMucHVzaCgndWkuYWNlJyk7XHJcbiAgYXBwLmZhY3RvcnkoJ0ZldGNoRmlsZUZhY3RvcnknLCBbJyRodHRwJywgZmV0Y2hGaWxlRmFjdG9yeSBdKTtcclxufSkoKTtcclxuIiwiKGZ1bmN0aW9uKCkge1xyXG4gICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBmdW5jdGlvbiBmaWxlQnJvd3NlckNvbnRyb2xsZXIoJHNjb3BlLCAkaHR0cCwkc2NlLEZldGNoRmlsZUZhY3RvcnksIHBkZkRlbGVnYXRlKSB7XHJcbiAgICAgIHZhciBlZGl0b3IgPSBhY2UuZWRpdChcImFjZUVkaXRvclwiKTtcclxuICAgICAgJHNjb3BlLmZpbGVWaWV3ZXIgPSAnUGxlYXNlIHNlbGVjdCBhIGZpbGUgdG8gdmlldyBpdHMgY29udGVudHMnO1xyXG4gICAgICAkKCcuY29udGVudCcpLmhpZGUoKTtcclxuICAgICAgJCgnLnRleHRDb250ZW50JykuaGlkZSgpO1xyXG4gICAgICAkKCcjbWVzc2FnZScpLmh0bWwoXCI8aDQ+UGxlYXNlIHNlbGVjdCBhIGZpbGUgdG8gdmlldyBpdHMgY29udGVudHM8L2g0PlwiKTtcclxuXHJcbiAgICAgIHZhciBCcG1uVmlld2VyID0gd2luZG93LkJwbW5KUztcclxuXHJcbiAgICAgICRzY29wZS50cmVlX2NvcmUgPSB7XHJcbiAgICAgICAgXHJcbiAgICAgICAgbXVsdGlwbGU6IGZhbHNlLFxyXG5cclxuICAgICAgICBjaGVja19jYWxsYmFjazogZnVuY3Rpb24gKG9wZXJhdGlvbiwgbm9kZSwgbm9kZV9wYXJlbnQsIG5vZGVfcG9zaXRpb24sIG1vcmUpIHtcclxuICAgICAgICAgICAgaWYgKG9wZXJhdGlvbiA9PT0gJ21vdmVfbm9kZScpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsgIFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgfTtcclxuXHJcbiAgICAgICRzY29wZS5ub2RlU2VsZWN0ZWQgPSBmdW5jdGlvbihlLCBkYXRhKSB7XHJcbiAgICAgICAgdmFyIF9sID0gZGF0YS5ub2RlLmxpX2F0dHI7XHJcbiAgICAgICAgaWYgKF9sLmlzTGVhZikge1xyXG4gICAgICAgICAgICBpZihfbC5pZC5pbmRleE9mKFwiLnBkZlwiKSA+IC0xKXtcclxuICAgICAgICAgICAgICAkKCcuY29udGVudCcpLmhpZGUoKTtcclxuICAgICAgICAgICAgICAkKCcudGV4dENvbnRlbnQnKS5zaG93KCk7XHJcbiAgICAgICAgICAgICAgJGh0dHAuZ2V0KCcvYXBpL3Jlc291cmNlP3Jlc291cmNlPScgKyBlbmNvZGVVUklDb21wb25lbnQoX2wuYmFzZSksIHsgcmVzcG9uc2VUeXBlOiAnYXJyYXlidWZmZXInIH0pXHJcbiAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAocmVzcG9uc2UpIHsgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZmlsZSA9IG5ldyBCbG9iKFtyZXNwb25zZV0sIHsgdHlwZTogJ2FwcGxpY2F0aW9uL3BkZicgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZpbGVVUkwgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGZpbGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5wZGZVcmwgPSAkc2NlLnRydXN0QXNSZXNvdXJjZVVybChmaWxlVVJMKS50b1N0cmluZygpO1xyXG4gICAgICAgICAgICAgICAgICAgIHBkZkRlbGVnYXRlLiRnZXRCeUhhbmRsZSggJ215LXBkZi1jb250YWluZXInICkubG9hZCggJHNjb3BlLnBkZlVybCApO1xyXG4gICAgICAgICAgICAgICAgICAgICQoJyNzYXZlJykuaGlkZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICQoJyNhY2VFZGl0b3InKS5oaWRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgJCgnI21lc3NhZ2UnKS5odG1sKFwiXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICQoJyNwZGZWaWV3ZXInKS5zaG93KCk7XHJcbiAgICAgICAgICAgICAgICB9KS5lcnJvcihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJFcnJvciBpbiByZWFkaW5nIHBkZlwiKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICBcdCAgICB9ZWxzZSBpZiAoX2wuaWQuaW5kZXhPZihcIi5icG1uXCIpID4gLTEpe1xyXG4gICAgICAgICAgICAgICAgJCgnLnRleHRDb250ZW50JykuaGlkZSgpO1xyXG4gICAgICAgICAgICAgICAgJCgnLmJqcy1jb250YWluZXInKS5yZW1vdmUoKTtcclxuICAgICAgICAgICAgICAgICQoJyNtZXNzYWdlJykuaHRtbChcIlwiKTtcclxuICAgICAgICAgICAgICAgICQoJy5jb250ZW50Jykuc2hvdygpO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBjb250YWluZXIgPSBhbmd1bGFyLmVsZW1lbnQoJyNqcy1kcm9wLXpvbmUnKTtcclxuICAgICAgICAgICAgICAgIHZhciB2aWV3ZXIgPSBuZXcgQnBtblZpZXdlcih7IGNvbnRhaW5lcjogY29udGFpbmVyfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgRmV0Y2hGaWxlRmFjdG9yeS5mZXRjaEZpbGUoX2wuYmFzZSkudGhlbihmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIF9kID0gZGF0YS5kYXRhO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgX2QgPT0gJ29iamVjdCcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICBfZCA9IEpTT04uc3RyaW5naWZ5KF9kLCB1bmRlZmluZWQsIDIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcblx0XHRcdFx0XHR2YXIgeG1sID0gX2Q7XHJcblxyXG5cdFx0XHRcdFx0dmlld2VyLmltcG9ydFhNTCh4bWwsIGZ1bmN0aW9uKGVycikge1xyXG5cdFx0XHRcdFx0XHR2YXIgY2FudmFzID0gdmlld2VyLmdldCgnY2FudmFzJyk7XHJcblx0XHRcdFx0XHRcdGNhbnZhcy56b29tKCdmaXQtdmlld3BvcnQnKTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH0pO1xyXG5cclxuXHRcdFx0XHQkc2NvcGUuc2F2ZUJwbW4gPSBmdW5jdGlvbiBzYXZlQnBtbigpeyAgXHJcbiAgICAgICAgICAgICAgICAgIFxyXG5cdFx0XHRcdFx0dmFyIGJwbW5YbWwgOyAgICAgICBcclxuXHRcdFx0XHRcdHZpZXdlci5zYXZlWE1MKHsgZm9ybWF0OiB0cnVlIH0sIGZ1bmN0aW9uKGVyciwgeG1sKSB7XHJcblx0XHRcdFx0XHRcdGJwbW5YbWwgPSB4bWw7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdFxyXG5cdFx0XHRcdFx0JGh0dHAucG9zdCgnL3NhdmUnLHsnY29udGVudCc6IGJwbW5YbWx9KS5zdWNjZXNzKGZ1bmN0aW9uKHJlc3BvbnNlKXtcclxuXHRcdFx0XHRcdFx0aWYocmVzcG9uc2UgPT0gJ1N1Y2Nlc3MnKXtcclxuXHRcdFx0XHRcdFx0XHQkKCcjbWVzc2FnZScpLmh0bWwoXCJXb3JrZmxvdyBlZGl0ZWQgc3VjY2Vzc2Z1bGx5XCIpO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZXtcclxuICAgICAgICAgICAgICAgICQoJy5jb250ZW50JykuaGlkZSgpO1xyXG5cdFx0XHRcdCQoJyNtZXNzYWdlJykuaHRtbChcIlwiKTtcclxuXHRcdFx0XHQkKCcudGV4dENvbnRlbnQnKS5zaG93KCk7XHJcbiAgICAgIFx0XHRcdEZldGNoRmlsZUZhY3RvcnkuZmV0Y2hGaWxlKF9sLmJhc2UpLnRoZW4oZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICBcdFx0XHRcdHZhciBfZCA9IGRhdGEuZGF0YTtcclxuICAgICAgXHRcdFx0XHRpZiAodHlwZW9mIF9kID09ICdvYmplY3QnKSB7XHJcbiAgICAgIFx0XHRcdFx0X2QgPSBKU09OLnN0cmluZ2lmeShfZCwgdW5kZWZpbmVkLCAyKTtcclxuICAgICAgXHRcdFx0XHR9XHJcbiAgICAgIFx0XHRcdFx0JHNjb3BlLmZpbGVWaWV3ZXIgPSBfZDtcclxuICAgICAgXHRcdFx0XHQkKCcjc2F2ZScpLnNob3coKTtcclxuICAgICAgXHRcdFx0XHQkKCcjbWVzc2FnZScpLmh0bWwoXCJcIik7XHJcbiAgICAgIFx0XHRcdFx0aWYoX2wuaWQuaW5kZXhPZihcIi54bWxcIikgPiAtMSB8fCBfbC5pZC5pbmRleE9mKFwiLnhzZFwiKSA+IC0xIHx8IF9sLmlkLmluZGV4T2YoXCIuYWN0aXZpdGlcIikgPiAtMSl7XHJcbiAgICAgIFx0XHRcdFx0ICAgZWRpdG9yLnNlc3Npb24uc2V0TW9kZShcImFjZS9tb2RlL3htbFwiKTtcclxuICAgICAgXHRcdFx0XHR9ZWxzZSBpZihfbC5pZC5pbmRleE9mKFwiLmRybFwiKSA+IC0xKXtcclxuICAgICAgXHRcdFx0XHQgICBlZGl0b3Iuc2Vzc2lvbi5zZXRNb2RlKFwiYWNlL21vZGUvZHJsZmlsZVwiKTtcclxuICAgICAgXHRcdFx0XHR9ZWxzZSBpZihfbC5pZC5pbmRleE9mKFwiLmh0bWxcIikgPiAtMSl7XHJcblx0XHRcdFx0XHQgICBlZGl0b3Iuc2Vzc2lvbi5zZXRNb2RlKFwiYWNlL21vZGUvaHRtbFwiKTtcclxuXHRcdFx0XHRcdH1lbHNlIGlmKF9sLmlkLmluZGV4T2YoXCIuZ3Jvb3Z5XCIpID4gLTEpe1xyXG5cdFx0XHRcdFx0ICAgZWRpdG9yLnNlc3Npb24uc2V0TW9kZShcImFjZS9tb2RlL2dyb292eVwiKTtcclxuXHRcdFx0XHRcdH1lbHNlIGlmKF9sLmlkLmluZGV4T2YoXCIucHJvcGVydGllc1wiKSA+IC0xKXtcclxuXHRcdFx0XHRcdCAgIGVkaXRvci5zZXNzaW9uLnNldE1vZGUoXCJhY2UvbW9kZS9wcm9wZXJ0aWVzXCIpO1xyXG5cdFx0XHRcdFx0fWVsc2V7XHJcbiAgICAgIFx0XHRcdFx0ICAgZWRpdG9yLnNlc3Npb24uc2V0TW9kZShcImFjZS9tb2RlL3RleHRcIik7XHJcbiAgICAgIFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0JCgnI2FjZUVkaXRvcicpLnNob3coKTtcclxuXHRcdFx0XHRcdCQoJyNwZGZWaWV3ZXInKS5oaWRlKCk7XHJcblx0XHRcdFx0XHRlZGl0b3IuJGJsb2NrU2Nyb2xsaW5nID0gSW5maW5pdHk7XHJcblx0XHRcdFx0XHRlZGl0b3Iuc2V0UmVhZE9ubHkoZmFsc2UpO1xyXG5cdFx0XHRcdFx0ZWRpdG9yLnNldFZhbHVlKF9kKTtcclxuXHRcdFx0XHR9KTtcclxuICAgICAgXHRcdH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgJHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgJHNjb3BlLmZpbGVWaWV3ZXIgPSAnUGxlYXNlIHNlbGVjdCBhIGZpbGUgdG8gdmlldyBpdHMgY29udGVudHMnO1xyXG4gICAgICAgICAgICAkKCcudGV4dENvbnRlbnQnKS5oaWRlKCk7XHJcbiAgICAgICAgICAgICQoJy5jb250ZW50JykuaGlkZSgpO1xyXG4gICAgICAgICAgICAkKCcjbWVzc2FnZScpLmh0bWwoXCI8aDQ+UGxlYXNlIHNlbGVjdCBhIGZpbGUgdG8gdmlldyBpdHMgY29udGVudHM8L2g0PlwiKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICB2YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ3N0ZXBOZXh0Jyk7XHJcbiAgICBhcHAucmVxdWlyZXMucHVzaCgnanNUcmVlLmRpcmVjdGl2ZScpO1xyXG4gICAgYXBwLnJlcXVpcmVzLnB1c2goJ3VpLmFjZScpO1xyXG4gICAgYXBwLnJlcXVpcmVzLnB1c2goJ3BkZicpO1xyXG4gICAgYXBwLmNvbnRyb2xsZXIoJ2ZpbGVCcm93c2VyQ29udHJvbGxlcicsIFtcIiRzY29wZVwiLFwiJGh0dHBcIixcIiRzY2VcIixcIkZldGNoRmlsZUZhY3RvcnlcIixcInBkZkRlbGVnYXRlXCIsIGZpbGVCcm93c2VyQ29udHJvbGxlcl0pO1xyXG59KSgpO1xyXG4iLCIoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gbW9kZWxlckNvbnRyb2xsZXIoJHNjb3BlLCAkaHR0cCkge1xyXG4gICAgICAgIC8vJHNjb3BlLm5hbWUgPSBcIk5pc2hhbnQgQ2hhdHVydmVkaVwiO1xyXG4gICAgICAgICRzY29wZS5zY2hlbWEgPSBcIlwiO1xyXG4gICAgICAgIChmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAvLyAkaHR0cC5nZXQoXCJodHRwOi8vbG9jYWxob3N0OjQ1MDAvdGVzdFwiKS50aGVuKGZ1bmN0aW9uKHJlcyl7XHJcbiAgICAgICAgICAgIC8vICAgICAkc2NvcGUuc2NoZW1hID0gcmVzLmRhdGE7XHJcbiAgICAgICAgICAgIC8vICAgICBjb25zb2xlLmxvZyhyZXMuZGF0YSk7XHJcbiAgICAgICAgICAgIC8vIH0pO1xyXG4gICAgICAgIH0pKCk7XHJcbiAgICAgICAgXHJcbiAgICB9XHJcblxyXG4gICAgYW5ndWxhci5tb2R1bGUoXCJzdGVwTmV4dFwiKS5jb250cm9sbGVyKFwibW9kZWxlckNvbnRyb2xsZXJcIiwgW1wiJHNjb3BlXCIsXCIkaHR0cFwiLCBtb2RlbGVyQ29udHJvbGxlcl0pO1xyXG59KSgpOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
